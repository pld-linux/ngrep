diff -Nur ngrep-1.41.org/configure.in ngrep-1.41/configure.in
--- ngrep-1.41.org/configure.in	2003-08-10 01:17:22.000000000 +0000
+++ ngrep-1.41/configure.in	2004-01-05 22:25:18.000000000 +0000
@@ -41,7 +41,7 @@
 
 for dir in $PCAP_DIR ; do 
     if test -d $dir -a -r "$dir/pcap.h" -a \
-                       -r "$dir/net/bpf.h" ; then 
+                       -r "$dir/pcap-bpf.h" ; then 
        if test -n "$pcap_dir" -a "$pcap_dir" != "$dir"; then
           echo 
           echo; echo more than one set found in:
@@ -67,14 +67,14 @@
    AC_SUBST(PCAP_INCLUDE)
    AC_SUBST(PCAP_LINK)
    
-   AC_MSG_CHECKING(for usable bpf.h)
-   if test -n "`grep DLT_RAW $pcap_dir/net/bpf.h`" ; then
+   AC_MSG_CHECKING(for usable pcap-bpf.h)
+   if test -n "`grep DLT_RAW $pcap_dir/pcap-bpf.h`" ; then
       echo yep
    else 
 
 echo nope
 echo '***************************************************************'
-echo an important define is missing from the bpf.h I found.  this
+echo an important define is missing from the pcap-bpf.h I found.  this
 echo probably means that your installation of pcap is outdated and
 echo needs upgrading.  I\'ll go ahead and add the define for you but
 echo understand that matching certain types of packets may not 
@@ -131,7 +131,7 @@
 AC_MSG_CHECKING(for DLT_LINUX_SLL in bpf.h)
 AC_EGREP_HEADER(yes, 
 [
-#include <net/bpf.h> 
+#include <pcap-bpf.h> 
 #ifdef DLT_LINUX_SLL
 yes
 #endif	 
@@ -140,10 +140,10 @@
 echo yes, 
 echo no)
 
-AC_MSG_CHECKING(for DLT_LOOP in bpf.h)
+AC_MSG_CHECKING(for DLT_LOOP in pcap-bpf.h)
 AC_EGREP_HEADER(yes, 
 [
-#include <net/bpf.h> 
+#include <pcap-bpf.h> 
 #ifdef DLT_LOOP
 yes
 #endif	 
@@ -152,10 +152,10 @@
 echo yes,
 echo no)
 
-AC_MSG_CHECKING(for DLT_IEEE802_11 in bpf.h)
+AC_MSG_CHECKING(for DLT_IEEE802_11 in pcap-bpf.h)
 AC_EGREP_HEADER(yes, 
 [
-#include <net/bpf.h> 
+#include <pcap-bpf.h> 
 #ifdef DLT_IEEE802_11
 yes
 #endif	 
@@ -194,7 +194,7 @@
 unsigned short bar = foo.uh_sport;
 ,
 	echo nope,
-        echo yep dumb; AC_DEFINE(HAVE_DUMB_UDPHDR))
+	 echo yep dumb;)
 
         ;;

 diff -Nur ngrep-1.41.org/ngrep.c ngrep-1.41/ngrep.c
--- ngrep-1.41.org/ngrep.c	2003-08-10 04:14:52.000000000 +0000
+++ ngrep-1.41/ngrep.c	2004-01-05 22:26:06.000000000 +0000
@@ -55,7 +55,7 @@
 #include <netinet/ip_icmp.h>
 
 #include <pcap.h>
-#include <net/bpf.h>
+#include <pcap-bpf.h>
 
 #include <stdlib.h>
 #include <string.h>
